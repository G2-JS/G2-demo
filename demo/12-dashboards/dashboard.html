<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>G2 - The Grammar Of Graphics </title>
  <meta name="keywords" content="G2, The Grammar of Graphics, 图形语法,图表绘制引擎,图表库,可视化,数据可视化,AntV,Data Visualization,visualization,visualisation, antd, ant, ant design">
  <meta name="description" content="G2(The Grammar Of Graphics) 是一个由纯 javascript 编写、强大的语义化图表生成工具，它提供了一整套图形语法，可以让用户通过简单的语法搭建出无数种图表，并且集成了大量的统计工具，支持多种坐标系绘制，可以让用户自由得定制图表，是为大数据时代而准备的强大的可视化工具。">
  <link rel="icon" href="https://os.alipayobjects.com/rmsportal/VuIJNnUTtJpfuej.png" type="image/x-icon">
  <link rel="shortcut icon" href="https://os.alipayobjects.com/rmsportal/PBJkVCMxFjrRGEl.png" type="image/x-icon">
  <link rel="stylesheet" type="text/css" href="../../static/style.css" />
  <link rel="stylesheet" type="text/css" href="../../static/codemirror.css" />
  <script src="https://a.alipayobjects.com/jquery/jquery/1.11.1/jquery.js"></script>
</head>
<body><header id="header">
  
</header>
 
  <div class="main-container clearfix">
<div class="body-content demo-detail">
<div class="demo-title clearfix">
  <h2 class="title">
    <a href="../../index.html#仪表盘">
      <span class="parent-title">仪表盘 / </span>
      <span class="title" id="J_chartTitle">仪表盘</span>
    </a>
  </h2>
</div>
<div class="doc-content demo-doc">
  <div class="doc-inner">
    <div class="chart-demo">
      <div id="c1"></div>
    </div>
    <div class="wrapper">
      <div class="code-panel pull-left">
        <div class="tabs">
          <div class="tab" >
            <input type="radio" name="css-tabs" id="tab-1" checked class="tab-switch">
            <label for="tab-1" class="tab-label">源码</label>
            <div class="tab-content">
              <textarea id='codeA' name='codeA'>
<!DOCTYPE html>
  <html>
    <head>
      <meta charset="utf-8">
      <title>仪表盘</title>
      <link rel="stylesheet" type="text/css" href="../../static/doc.css" />
      <!--如果不需要jquery ajax 则可以不引入-->
      <script src="https://a.alipayobjects.com/jquery/jquery/1.11.1/jquery.js"></script>
      <!-- 引入 G2 脚本 --><script src="https://a.alipayobjects.com/g/datavis/g2/2.3.0/g2.js"></script>
    </head>
    <body>
      <div id="c1"></div>
      <!-- G2 code start -->
      <script>
var Shape = G2.Shape;

// 自定义Shape 部分
Shape.registShape('point', 'dashBoard', {
  drawShape: function(cfg, group){
    var origin = cfg.origin; // 原始数据
    var value = origin.value;
    var point = cfg.points[0]; // 获取第一个标记点
    point = this.parsePoint({ // 将标记点转换到画布坐标
      x: point.x,
      y: 0.95
    });
    var center = this.parsePoint({ // 获取极坐标系下画布中心点
      x: 0,
      y: 0
    });
    var r = 20;
    var ra = 0.8 * r;
    var X1 = center.x;
    var Y1 = center.y;
    var X2 = point.x;
    var Y2 = point.y;
    var B = 150/180;
    var Xa,Xb,Xc,Ya,Yb,Yc; // 绘制小箭头需要的三个点
    var shape;

    if (Y1==Y2) {
      if(X1>X2){
        Xa = X2 + Math.cos(B)* ra;
        Ya = Y2 - Math.sin(B)* ra;
        Xb = X2 + Math.cos(B)* ra;
        Yb = Y2 + Math.sin(B)* ra;
        Xc = X2 + 2 * ra;
        Yc = Y2;
      }else{
        Xa = X2 - Math.cos(B)* ra;
        Ya = Y2 - Math.sin(B)* ra;
        Xb = X2 - Math.cos(B)* ra;
        Yb = Y2 + Math.sin(B)* ra;
        Xc = X2 - 2 * ra;
        Yc = Y2;
      }
    }else if(Y1>Y2){
      var A = Math.atan((X1 - X2) / (Y1 - Y2));
      Xa = X2 + ra * Math.sin(A + B);
      Ya = Y2 + ra * Math.cos(A + B);
      Xb = X2 + ra * Math.sin(A - B);
      Yb = Y2 + ra * Math.cos(A - B);
      Xc = X2 + 2 * ra * Math.sin(A);
      Yc = Y2 + 2 * ra * Math.cos(A);
    }else{
      if(X1>X2){
        var A = Math.atan((Y2 - Y1) / (X1 - X2));
          Xa = X2 + ra * Math.cos(A + B);
          Ya = Y2 - ra * Math.sin(A + B);
          Xb = X2 + ra * Math.cos(A - B);
          Yb = Y2 - ra * Math.sin(A - B);
          Xc = X2 + 2 * ra * Math.cos(A);
          Yc = Y2 - 2 * ra * Math.sin(A);
        }else{
          var A = Math.atan((Y2 - Y1) / (X2 - X1));
          Xa = X2 - ra * Math.cos(A - B);
          Ya = Y2 - ra * Math.sin(A - B);
          Xb = X2 - ra * Math.cos(A + B);
          Yb = Y2 - ra * Math.sin(A + B);
          Xc = X2 - 2 * ra * Math.cos(A);
          Yc = Y2 - 2 * ra * Math.sin(A);
        }
    }

    shape = group.addShape('circle', {
      attrs:{
        x: X2,
        y: Y2,
        r: r,
        fill: cfg.color
      }
    });

    group.addShape('circle', {
      attrs:{
        x: X2,
        y: Y2,
        r: r/2,
        fill: 'white'
      }
    });

    // 添加文本1
    group.addShape('text', {
      attrs: {
        x: X1,
        y: Y1-25,
        text: '当前收益率',
        fontSize: 32,
        fill: '#CCCCCC',
        textAlign: 'center'
      }
    });

    // 添加文本2
    group.addShape('text', {
      attrs: {
        x: X1,
        y: Y1+25,
        text: value,
        fontSize: 32,
        fill: '#F75B5B',
        textAlign: 'center'
      }
    });

    group.addShape('polygon', {
      attrs: {
        points: [
          [Xa, Ya],
          [Xc, Yc],
          [Xb, Yb],
          [Xa, Ya]
        ],
        fill: cfg.color
      }
    });
    return shape;
  }
});

// G2 语法部分
var color = ['#18B7D6', '#EFCF6E', '#E47668'];
var chart = new G2.Chart({
  id : 'c1',
  width: 1000,
  height: 500,
  plotCfg: {
    margin: 100
  }
});

chart.source(creatData());
chart.coord('gauge', {
  startAngle: -9/8 * Math.PI,
  endAngle: 1/8 * Math.PI
});
chart.col('value', {
  min: 0,
  max: 0.15,
  tickInterval: 0.075
});
chart.axis('value', {
  tickLine: {
    stroke: '#EEEEEE'
  },
  labelOffset: -26
});
chart.point().position('value').shape('dashBoard').color('value', function(v){ // 根据值的大小确定标记的颜色
  var rst;
  if ( v < 0.05 ) {
    rst = color[0];
  } else if ( v < 0.1 ){
    rst = color[1];
  } else {
    rst = color[2];
  }
  return rst;
});
chart.legend(false);
draw(creatData());
setInterval(function(){
  draw(creatData());
}, 1000);

function draw(data) {
  var val = data[0].value;
  var lineWidth = 30;
  chart.guide().clear();
  chart.guide().arc([0, 0.95],[0.15, 0.95],{ // 底灰色
    stroke: '#CCCCCC',
    lineWidth: lineWidth
  });
  val > 0.05 && chart.guide().arc([0, 0.95],[0.05, 0.95],{ // 低收益率
    stroke: color[0],
    lineWidth: lineWidth
  });
  val > 0.1 && chart.guide().arc([0.05, 0.95],[0.1, 0.95],{ // 中收益率
    stroke: color[1],
    lineWidth: lineWidth
  });
  val > 0 && val <= 0.05 && chart.guide().arc([0, 0.95],[val, 0.95],{ // 低收益率
    stroke: color[0],
    lineWidth: lineWidth
  });
  val > 0.05 && val <= 0.1 && chart.guide().arc([0.05, 0.95],[val, 0.95],{ // 中收益率
    stroke: color[1],
    lineWidth: lineWidth
  });
  val > 0.1 && val <= 0.15 && chart.guide().arc([0.1, 0.95],[val, 0.95],{ // 中收益率
    stroke: color[2],
    lineWidth: lineWidth
  });
  chart.changeData(data);
}

function creatData(){
  var data = [];
  var val = Math.random() * 0.15;
  val = val.toFixed(3);
  data.push({value: Number(val)});
  return data;
}
</script>

      <!-- G2 code end -->
    </body>
  </html>
              </textarea>
            </div>
          </div>
          
        </div>
        
      </div>
    </div>
  </div>
</div>
</div><script src="https://a.alipayobjects.com/g/datavis/g2/2.3.0/g2.js"></script>
<script>
var Shape = G2.Shape;

// 自定义Shape 部分
Shape.registShape('point', 'dashBoard', {
  drawShape: function(cfg, group){
    var origin = cfg.origin; // 原始数据
    var value = origin.value;
    var point = cfg.points[0]; // 获取第一个标记点
    point = this.parsePoint({ // 将标记点转换到画布坐标
      x: point.x,
      y: 0.95
    });
    var center = this.parsePoint({ // 获取极坐标系下画布中心点
      x: 0,
      y: 0
    });
    var r = 20;
    var ra = 0.8 * r;
    var X1 = center.x;
    var Y1 = center.y;
    var X2 = point.x;
    var Y2 = point.y;
    var B = 150/180;
    var Xa,Xb,Xc,Ya,Yb,Yc; // 绘制小箭头需要的三个点
    var shape;

    if (Y1==Y2) {
      if(X1>X2){
        Xa = X2 + Math.cos(B)* ra;
        Ya = Y2 - Math.sin(B)* ra;
        Xb = X2 + Math.cos(B)* ra;
        Yb = Y2 + Math.sin(B)* ra;
        Xc = X2 + 2 * ra;
        Yc = Y2;
      }else{
        Xa = X2 - Math.cos(B)* ra;
        Ya = Y2 - Math.sin(B)* ra;
        Xb = X2 - Math.cos(B)* ra;
        Yb = Y2 + Math.sin(B)* ra;
        Xc = X2 - 2 * ra;
        Yc = Y2;
      }
    }else if(Y1>Y2){
      var A = Math.atan((X1 - X2) / (Y1 - Y2));
      Xa = X2 + ra * Math.sin(A + B);
      Ya = Y2 + ra * Math.cos(A + B);
      Xb = X2 + ra * Math.sin(A - B);
      Yb = Y2 + ra * Math.cos(A - B);
      Xc = X2 + 2 * ra * Math.sin(A);
      Yc = Y2 + 2 * ra * Math.cos(A);
    }else{
      if(X1>X2){
        var A = Math.atan((Y2 - Y1) / (X1 - X2));
          Xa = X2 + ra * Math.cos(A + B);
          Ya = Y2 - ra * Math.sin(A + B);
          Xb = X2 + ra * Math.cos(A - B);
          Yb = Y2 - ra * Math.sin(A - B);
          Xc = X2 + 2 * ra * Math.cos(A);
          Yc = Y2 - 2 * ra * Math.sin(A);
        }else{
          var A = Math.atan((Y2 - Y1) / (X2 - X1));
          Xa = X2 - ra * Math.cos(A - B);
          Ya = Y2 - ra * Math.sin(A - B);
          Xb = X2 - ra * Math.cos(A + B);
          Yb = Y2 - ra * Math.sin(A + B);
          Xc = X2 - 2 * ra * Math.cos(A);
          Yc = Y2 - 2 * ra * Math.sin(A);
        }
    }

    shape = group.addShape('circle', {
      attrs:{
        x: X2,
        y: Y2,
        r: r,
        fill: cfg.color
      }
    });

    group.addShape('circle', {
      attrs:{
        x: X2,
        y: Y2,
        r: r/2,
        fill: 'white'
      }
    });

    // 添加文本1
    group.addShape('text', {
      attrs: {
        x: X1,
        y: Y1-25,
        text: '当前收益率',
        fontSize: 32,
        fill: '#CCCCCC',
        textAlign: 'center'
      }
    });

    // 添加文本2
    group.addShape('text', {
      attrs: {
        x: X1,
        y: Y1+25,
        text: value,
        fontSize: 32,
        fill: '#F75B5B',
        textAlign: 'center'
      }
    });

    group.addShape('polygon', {
      attrs: {
        points: [
          [Xa, Ya],
          [Xc, Yc],
          [Xb, Yb],
          [Xa, Ya]
        ],
        fill: cfg.color
      }
    });
    return shape;
  }
});

// G2 语法部分
var color = ['#18B7D6', '#EFCF6E', '#E47668'];
var chart = new G2.Chart({
  id : 'c1',
  width: 1000,
  height: 500,
  plotCfg: {
    margin: 100
  }
});

chart.source(creatData());
chart.coord('gauge', {
  startAngle: -9/8 * Math.PI,
  endAngle: 1/8 * Math.PI
});
chart.col('value', {
  min: 0,
  max: 0.15,
  tickInterval: 0.075
});
chart.axis('value', {
  tickLine: {
    stroke: '#EEEEEE'
  },
  labelOffset: -26
});
chart.point().position('value').shape('dashBoard').color('value', function(v){ // 根据值的大小确定标记的颜色
  var rst;
  if ( v < 0.05 ) {
    rst = color[0];
  } else if ( v < 0.1 ){
    rst = color[1];
  } else {
    rst = color[2];
  }
  return rst;
});
chart.legend(false);
draw(creatData());
setInterval(function(){
  draw(creatData());
}, 1000);

function draw(data) {
  var val = data[0].value;
  var lineWidth = 30;
  chart.guide().clear();
  chart.guide().arc([0, 0.95],[0.15, 0.95],{ // 底灰色
    stroke: '#CCCCCC',
    lineWidth: lineWidth
  });
  val > 0.05 && chart.guide().arc([0, 0.95],[0.05, 0.95],{ // 低收益率
    stroke: color[0],
    lineWidth: lineWidth
  });
  val > 0.1 && chart.guide().arc([0.05, 0.95],[0.1, 0.95],{ // 中收益率
    stroke: color[1],
    lineWidth: lineWidth
  });
  val > 0 && val <= 0.05 && chart.guide().arc([0, 0.95],[val, 0.95],{ // 低收益率
    stroke: color[0],
    lineWidth: lineWidth
  });
  val > 0.05 && val <= 0.1 && chart.guide().arc([0.05, 0.95],[val, 0.95],{ // 中收益率
    stroke: color[1],
    lineWidth: lineWidth
  });
  val > 0.1 && val <= 0.15 && chart.guide().arc([0.1, 0.95],[val, 0.95],{ // 中收益率
    stroke: color[2],
    lineWidth: lineWidth
  });
  chart.changeData(data);
}

function creatData(){
  var data = [];
  var val = Math.random() * 0.15;
  val = val.toFixed(3);
  data.push({value: Number(val)});
  return data;
}
</script>


<script src="../../static/codemirror-compressed.js"></script>
<script src="../../static/demo-detail.js"></script>

  </div>
  
 
</body>
</html>